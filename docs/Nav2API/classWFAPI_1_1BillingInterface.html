<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Nav2API - The Navigation library: WFAPI::BillingInterface Class Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.7 -->
<div class="tabs">
  <ul>
    <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
    <li id="current"><a href="annotated.html"><span>Classes</span></a></li>
    <li><a href="files.html"><span>Files</span></a></li>
    <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
  </ul></div>
<div class="tabs">
  <ul>
    <li><a href="annotated.html"><span>Class&nbsp;List</span></a></li>
    <li><a href="hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
    <li><a href="functions.html"><span>Class&nbsp;Members</span></a></li>
  </ul></div>
<div class="nav">
<b>WFAPI</b>::<a class="el" href="classWFAPI_1_1BillingInterface.html">BillingInterface</a></div>
<h1>WFAPI::BillingInterface Class Reference</h1><!-- doxytag: class="WFAPI::BillingInterface" --><!-- doxytag: inherits="WFAPI::Interface" --><code>#include &lt;<a class="el" href="BillingInterface_8h-source.html">BillingInterface.h</a>&gt;</code>
<p>
Inheritance diagram for WFAPI::BillingInterface:<center><font size="2">[<a target="top" href="graph_legend.html">legend</a>]</font></center>Collaboration diagram for WFAPI::BillingInterface:<center><font size="2">[<a target="top" href="graph_legend.html">legend</a>]</font></center><a href="classWFAPI_1_1BillingInterface-members.html">List of all members.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWFAPI_1_1BillingInterface.html#2fa3dfe1b92ff26c7f5caf5c6228c35a">~BillingInterface</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWFAPI_1_1BillingInterface.html#562800754513e1ba0de8fd4e793829c7">addBillingListener</a> (<a class="el" href="classWFAPI_1_1BillingListener.html">BillingListener</a> *listener)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWFAPI_1_1BillingInterface.html#9952156de74ca5bf4d66c008fb295291">removeBillingListener</a> (<a class="el" href="classWFAPI_1_1BillingListener.html">BillingListener</a> *listener)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="classWFAPI_1_1AsynchronousStatus.html">AsynchronousStatus</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWFAPI_1_1BillingInterface.html#3d8aac6a241df808b22b7897d898289e">verifyThirdPartyTransaction</a> (const <a class="el" href="classWFAPI_1_1WFString.html">WFString</a> &amp;transactionID, const <a class="el" href="classWFAPI_1_1WFString.html">WFString</a> &amp;selectionString)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">BillingInterfaceImpl *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWFAPI_1_1BillingInterface.html#180abe3f0d3122f5e928426038e646e8">getImpl</a> ()</td></tr>

</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
<a class="el" href="classWFAPI_1_1Interface.html">Interface</a> class for billing operations.<p>
The following billing flows are currently supported.<p>
1. Some request is issued to the server (for instance RouteInterface::routeRequest).<p>
2. The current user account does not have sufficient rights in order to process the request and the registered listener gets a reply in its <a class="el" href="classWFAPI_1_1Listener.html#884988686a6b79bac43a890f4b959270">Listener::error</a> method including an <a class="el" href="classWFAPI_1_1AsynchronousStatus.html">AsynchronousStatus</a> object.<p>
3.1. [Alternative 1] In case the current phone platform and client supports web based billing, the status object contains an URL in <a class="el" href="classWFAPI_1_1SynchronousStatus.html#9e3e256acba0eb969a0a4f578095fb42">AsynchronousStatus::getStatusURL()</a> which points to a web page where the user can purchase products in order to be able to perform the previous action succesfully. In case of completing the purchase, the web page will automatically update the user account on the server with the new updated rights. For this alternative there is no need to use the <a class="el" href="classWFAPI_1_1BillingInterface.html">BillingInterface</a>.<p>
3.2. [Alternative 2] In case the current phone platform and client supports client side billing (i.e. non web based) through direct client side third part API calls, the status object will instead return a non empty string when calling the <a class="el" href="classWFAPI_1_1SynchronousStatus.html#cc54d065ed055ac564cfa42eb8a135c9">AsynchronousStatus::getStatusData()</a> method. This status data will contain a product id which corresponds to the product that can be purchased in order to be able to perform the previous action succesfully. The status data string is formatted as "&lt;status data type&gt;;&lt;status data value&gt;". Currently the iPhone, with App Store billing, is the only supported platform for this type of billing integration. For the iPhone platform the status data type is "iPhoneAppStore" and the status data value is the corresponding App Store product id.<p>
4.2 [Alternative 2] The client application calls the third party billing methods supplying the product id originating from the status data. Succesful billing, results in that a transaction id or receipt is received. This means that the user has been billed, but the server has not yet been updated with the corresponding user rights.<p>
5.2 [Alternative 2] In order to update the rights on the server due to the purchased product, the application calls <a class="el" href="classWFAPI_1_1BillingInterface.html#3d8aac6a241df808b22b7897d898289e">BillingInterface::verifyThirdPartyTransaction()</a> supplying the transaction id or receipt from the previous billing as parameter. The server will then verify the purchase and upon success add the corresponding rights to the user account and indicate the successful operation by calling <a class="el" href="classWFAPI_1_1BillingListener.html#e43b920878d28f02aedb4ee201cb5edc">BillingListener::thirdPartyTransactionVerified</a>. If the verification fails, then no rights will be added and the <a class="el" href="classWFAPI_1_1Listener.html#884988686a6b79bac43a890f4b959270">Listener::error</a> will be called.<p>
<dl compact><dt><b>See also:</b></dt><dd><a class="el" href="classWFAPI_1_1BillingListener.html">BillingListener</a> <p>
<a class="el" href="classWFAPI_1_1SynchronousStatus.html">SynchronousStatus</a> </dd></dl>

<p>
<hr><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" name="2fa3dfe1b92ff26c7f5caf5c6228c35a"></a><!-- doxytag: member="WFAPI::BillingInterface::~BillingInterface" ref="2fa3dfe1b92ff26c7f5caf5c6228c35a" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual WFAPI::BillingInterface::~BillingInterface           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Destructor. 
</div>
</div><p>
<hr><h2>Member Function Documentation</h2>
<a class="anchor" name="562800754513e1ba0de8fd4e793829c7"></a><!-- doxytag: member="WFAPI::BillingInterface::addBillingListener" ref="562800754513e1ba0de8fd4e793829c7" args="(BillingListener *listener)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void WFAPI::BillingInterface::addBillingListener           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classWFAPI_1_1BillingListener.html">BillingListener</a> *&nbsp;</td>
          <td class="paramname"> <em>listener</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Add a listener for billing events. <dl compact><dt><b>See also:</b></dt><dd><a class="el" href="classWFAPI_1_1BillingListener.html">BillingListener</a></dd></dl>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>listener</em>&nbsp;</td><td>The <a class="el" href="classWFAPI_1_1BillingListener.html">BillingListener</a> to add. It may not be deleted until it is removed by calling removeBillingListener. </td></tr>
  </table>
</dl>

</div>
</div><p>
<a class="anchor" name="180abe3f0d3122f5e928426038e646e8"></a><!-- doxytag: member="WFAPI::BillingInterface::getImpl" ref="180abe3f0d3122f5e928426038e646e8" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BillingInterfaceImpl* WFAPI::BillingInterface::getImpl           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Internal function. 
</div>
</div><p>
<a class="anchor" name="9952156de74ca5bf4d66c008fb295291"></a><!-- doxytag: member="WFAPI::BillingInterface::removeBillingListener" ref="9952156de74ca5bf4d66c008fb295291" args="(BillingListener *listener)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void WFAPI::BillingInterface::removeBillingListener           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classWFAPI_1_1BillingListener.html">BillingListener</a> *&nbsp;</td>
          <td class="paramname"> <em>listener</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Remove a listener.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>listener</em>&nbsp;</td><td>The <a class="el" href="classWFAPI_1_1BillingListener.html">BillingListener</a> to remove. It should now be deleted by caller, unless caller keeps it around for later use. </td></tr>
  </table>
</dl>

</div>
</div><p>
<a class="anchor" name="3d8aac6a241df808b22b7897d898289e"></a><!-- doxytag: member="WFAPI::BillingInterface::verifyThirdPartyTransaction" ref="3d8aac6a241df808b22b7897d898289e" args="(const WFString &amp;transactionID, const WFString &amp;selectionString)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classWFAPI_1_1AsynchronousStatus.html">AsynchronousStatus</a> WFAPI::BillingInterface::verifyThirdPartyTransaction           </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classWFAPI_1_1WFString.html">WFString</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>transactionID</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classWFAPI_1_1WFString.html">WFString</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>selectionString</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Verify a third party transaction with the server. In case of succesful verification of the transaction, the associcated rights will be added to the current account on the server.<p>
This method should be called after completed client side billing (non web based) from purchasing a product originating from <a class="el" href="classWFAPI_1_1SynchronousStatus.html#cc54d065ed055ac564cfa42eb8a135c9">SynchronousStatus::getStatusData</a>.<p>
<dl compact><dt><b>See also:</b></dt><dd><a class="el" href="classWFAPI_1_1SynchronousStatus.html">SynchronousStatus</a></dd></dl>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>transactionID</em>&nbsp;</td><td>The transaction ID, or receipt, of the third party transaction. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>selectionString</em>&nbsp;</td><td>The selection that the user made from the StatusData from <a class="el" href="classWFAPI_1_1SynchronousStatus.html">SynchronousStatus</a>.</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>The status and if status is OK the <a class="el" href="classWFAPI_1_1RequestID.html">RequestID</a> that will be returned in the <a class="el" href="classWFAPI_1_1BillingListener.html#e43b920878d28f02aedb4ee201cb5edc">BillingListener::thirdPartyTransactionVerified()</a> function. </dd></dl>

</div>
</div><p>
<hr>The documentation for this class was generated from the following file:<ul>
<li><a class="el" href="BillingInterface_8h-source.html">BillingInterface.h</a></ul>
<hr size="1"><address style="align: right;"><small>Generated on Mon Jun 28 20:50:17 2010 for Nav2API - The Navigation library by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.7 </small></address>
</body>
</html>
